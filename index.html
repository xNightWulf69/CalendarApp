<!DOCTYPE html>
<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Task Scheduler</title><link rel="manifest" href="manifest.json"><meta name="theme-color" content="#667eea"><link rel="apple-touch-icon" href="CalendarApp/android-chrome-192x192.png"><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:system-ui;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:10px}.c{max-width:800px;margin:0 auto;background:rgba(255,255,255,.95);border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,.1);overflow:hidden}.h{background:linear-gradient(135deg,#ff6b6b,#ee5a24);color:#fff;padding:20px;text-align:center}.h h1{font-size:2em;margin-bottom:5px}.mc{padding:20px}.tabs{display:flex;margin-bottom:20px;border-bottom:2px solid #e1e8ed}.tab{padding:10px 20px;cursor:pointer;border-bottom:3px solid transparent;transition:all .3s}.tab.active{border-bottom-color:#667eea;color:#667eea}.tc{display:none}.tc.active{display:block}label{display:block;margin:5px 0 3px;color:#555;font-size:14px}input,select,textarea{width:100%;padding:8px;border:1px solid #ddd;border-radius:5px;font-size:14px}input:focus,select:focus,textarea:focus{outline:none;border-color:#667eea}.fg{margin-bottom:15px}.ro{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px;margin-top:8px}.rop{padding:10px;border:1px solid #ddd;border-radius:5px;cursor:pointer;text-align:center;transition:all .3s}.rop:hover,.rop.selected{border-color:#667eea;background:rgba(102,126,234,.1)}.ds{display:grid;grid-template-columns:repeat(7,1fr);gap:5px;margin-top:10px}.db{padding:8px 4px;border:1px solid #ddd;border-radius:5px;text-align:center;cursor:pointer;transition:all .3s}.db:hover,.db.selected{background:#667eea;color:#fff}.btn{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;width:100%;margin-top:10px}.btn:hover{opacity:.9}.btn-s{padding:5px 10px;width:auto;margin-left:10px}.btn-d{background:linear-gradient(135deg,#ff6b6b,#ee5a24)}.btn-c{background:linear-gradient(135deg,#ff1493,#ff69b4)}.cal{background:#fff;border-radius:10px;padding:15px;box-shadow:0 3px 10px rgba(0,0,0,.1)}.ch{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.cn{background:#667eea;color:#fff;border:none;padding:8px 12px;border-radius:5px;cursor:pointer}.cg{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:#e1e8ed;border-radius:8px;overflow:hidden}.cdh{background:#f8f9fa;padding:10px 3px;text-align:center;font-weight:600;color:#555;font-size:12px}.cd{background:#fff;min-height:60px;padding:5px;cursor:pointer;position:relative}.cd:hover{background:#f8f9fa}.cd.other-month{color:#ccc;background:#f9f9f9}.cd.today{background:#667eea;color:#fff}.dn{font-weight:600;margin-bottom:3px;font-size:12px}.tp{font-size:10px;padding:1px 3px;margin:1px 0;border-radius:3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tp.alex{background:rgba(52,152,219,.6);color:#fff}.tp.bethany{background:rgba(231,76,60,.6);color:#fff}.tp.both{background:rgba(46,204,113,.6);color:#fff}.tp.alternating{background:rgba(255,165,0,.6);color:#8b4513}.tp.completed{background:#ff1493!important;color:#fff!important}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);z-index:1000}.modal-content{background:#fff;margin:30px auto;padding:20px;border-radius:10px;max-width:500px;max-height:80vh;overflow-y:auto}.mh{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.close{font-size:24px;cursor:pointer;color:#aaa}.close:hover{color:#000}.td{margin-bottom:15px;padding:10px;border:1px solid #ddd;border-radius:5px}.td.completed{background:#ffe0f0;border-color:#ff69b4}.hidden{display:none}.sync{background:rgba(52,152,219,.1);border:1px solid rgba(52,152,219,.3);color:#2980b9;padding:10px;border-radius:5px;text-align:center;margin-bottom:15px}.sync button{background:#3498db;color:#fff;border:none;padding:5px 15px;border-radius:3px;cursor:pointer;margin:3px}.emoji-picker{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.15);z-index:100;max-height:200px;overflow-y:auto}.emoji-grid{display:grid;grid-template-columns:repeat(8,1fr);gap:2px;padding:8px}.emoji-option{padding:8px;text-align:center;cursor:pointer;border-radius:4px;font-size:18px;transition:background .2s}.emoji-option:hover{background:#f0f0f0}@media (max-width:600px){.cd{min-height:50px;padding:3px}.tp{font-size:9px}.ro{grid-template-columns:1fr}}</style></head><body><div class="c"><div class="h"><h1>📅 Task Scheduler</h1><p>Sync tasks with Firebase</p></div><div class="mc"><div class="tabs"><div class="tab active" data-tab="calendar">📅 Calendar</div><div class="tab" data-tab="add-task">➕ Add</div><div class="tab" data-tab="settings">⚙️ Settings</div></div><div class="tc active" id="calendar"><div class="sync"><div id="sync-status">Connecting...</div><button onclick="ts.syncNow()">Sync</button></div><div class="cal"><div class="ch"><button class="cn" id="pm">‹</button><h2 id="cm">January 2025</h2><button class="cn" id="nm">›</button></div><div class="cg" id="cg"></div></div></div><div class="tc" id="add-task"><form id="tf"><div class="fg"><label>Task Name</label><input type="text" id="tn" placeholder="Hoovering" required></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px"><div class="fg"><label>Emoji</label><div style="position:relative"><input type="text" id="te" placeholder="🧹" maxlength="2" readonly style="cursor:pointer"><div id="emoji-picker" class="emoji-picker hidden"><div class="emoji-grid"><span class="emoji-option" data-emoji="🧹">🧹</span><span class="emoji-option" data-emoji="🧽">🧽</span><span class="emoji-option" data-emoji="🧴">🧴</span><span class="emoji-option" data-emoji="🪣">🪣</span><span class="emoji-option" data-emoji="🧼">🧼</span><span class="emoji-option" data-emoji="🗑️">🗑️</span><span class="emoji-option" data-emoji="♻️">♻️</span><span class="emoji-option" data-emoji="🚿">🚿</span><span class="emoji-option" data-emoji="🛁">🛁</span><span class="emoji-option" data-emoji="🧺">🧺</span><span class="emoji-option" data-emoji="👕">👕</span><span class="emoji-option" data-emoji="🍽️">🍽️</span><span class="emoji-option" data-emoji="🥄">🥄</span><span class="emoji-option" data-emoji="🪟">🪟</span><span class="emoji-option" data-emoji="🛏️">🛏️</span><span class="emoji-option" data-emoji="🏠">🏠</span><span class="emoji-option" data-emoji="🔧">🔧</span><span class="emoji-option" data-emoji="⚙️">⚙️</span><span class="emoji-option" data-emoji="💡">💡</span><span class="emoji-option" data-emoji="🌱">🌱</span><span class="emoji-option" data-emoji="💧">💧</span><span class="emoji-option" data-emoji="🔥">🔥</span><span class="emoji-option" data-emoji="❄️">❄️</span><span class="emoji-option" data-emoji="📋">📋</span><span class="emoji-option" data-emoji="✅">✅</span><span class="emoji-option" data-emoji="⭐">⭐</span><span class="emoji-option" data-emoji="💪">💪</span><span class="emoji-option" data-emoji="⏰">⏰</span><span class="emoji-option" data-emoji="📝">📝</span><span class="emoji-option" data-emoji="🎯">🎯</span><span class="emoji-option" data-emoji="🚀">🚀</span></div></div></div></div><div class="fg"><label>Time</label><input type="time" id="tt" required></div></div><div class="fg"><label>Assigned To</label><div class="ro"><div class="rop" data-value="alex">👨 Alex</div><div class="rop" data-value="bethany">👩 Bethany</div><div class="rop" data-value="both">👥 Both</div><div class="rop" data-value="alternating">🔄 Alt</div></div></div><div id="alt-start" class="fg hidden"><label>Start With</label><select id="as"><option value="alex">👨 Alex</option><option value="bethany">👩 Bethany</option></select></div><div class="fg"><label>Repeat</label><div class="ro"><div class="rop" data-value="daily">Daily</div><div class="rop" data-value="every-other-day">Every Other Day</div><div class="rop" data-value="weekly">Weekly</div><div class="rop" data-value="twice-weekly">Twice Weekly</div><div class="rop" data-value="monthly">Monthly</div><div class="rop" data-value="quarterly">Quarterly</div><div class="rop" data-value="custom">Custom</div></div></div><div id="start-day" class="fg hidden"><label>Start Day</label><select id="std"><option value="1">Monday</option><option value="2">Tuesday</option><option value="3">Wednesday</option><option value="4">Thursday</option><option value="5">Friday</option><option value="6">Saturday</option><option value="7">Sunday</option></select></div><div id="week-day" class="fg hidden"><label>Day</label><select id="wd"><option value="1">Monday</option><option value="2">Tuesday</option><option value="3">Wednesday</option><option value="4">Thursday</option><option value="5">Friday</option><option value="6">Saturday</option><option value="7">Sunday</option></select></div><div id="twice-days" class="fg hidden"><label>Select 2 Days</label><div class="ds"><div class="db" data-day="1">M</div><div class="db" data-day="2">T</div><div class="db" data-day="3">W</div><div class="db" data-day="4">T</div><div class="db" data-day="5">F</div><div class="db" data-day="6">S</div><div class="db" data-day="7">S</div></div></div><div id="month-day" class="fg hidden"><label>Day of Month</label><select id="md"></select></div><div id="custom-days" class="fg hidden"><label>Days</label><div class="ds"><div class="db" data-day="1">M</div><div class="db" data-day="2">T</div><div class="db" data-day="3">W</div><div class="db" data-day="4">T</div><div class="db" data-day="5">F</div><div class="db" data-day="6">S</div><div class="db" data-day="7">S</div></div></div><button type="submit" class="btn">Add Task</button></form></div><div class="tc" id="settings"><div class="fg"><label>Room Code</label><input type="text" id="room-code" placeholder="Enter room code"><button class="btn-s" onclick="ts.joinRoom()">Join</button></div><div class="fg"><label>Your Room</label><input type="text" id="my-room" readonly><button class="btn-s" onclick="ts.copyRoom()">Copy</button></div><div class="fg"><label>I am</label><div class="ro"><div class="rop" data-value="alex">👨 Alex</div><div class="rop" data-value="bethany">👩 Bethany</div></div></div><button id="en" class="btn">Enable Notifications</button></div></div></div><div id="tm" class="modal"><div class="modal-content"><div class="mh"><h3 id="md">Tasks</h3><span class="close" onclick="document.getElementById('tm').style.display='none'">&times;</span></div><div id="mt"></div></div></div><script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script><script>const firebaseConfig={apiKey:"AIzaSyDOJDFbk8u6KOwxxZ9W2FbxuleFYulZkdo",authDomain:"calendarapp321.firebaseapp.com",projectId:"calendarapp321",storageBucket:"calendarapp321.firebasestorage.app",messagingSenderId:"790778062640",appId:"1:790778062640:web:2e509c5a6ad526412e4af5",measurementId:"G-VC2DBYPV05"};class TaskScheduler{constructor(){firebase.initializeApp(firebaseConfig);this.db=firebase.firestore();this.tasks=[];this.currentDate=new Date();this.selectedDays=new Set();this.selectedAssignment='';this.selectedRepeat='';this.roomId=localStorage.getItem('roomId')||this.generateRoomId();this.completions={};this.currentUser=localStorage.getItem('currentUser')||'';this.init()}generateRoomId(){return Math.random().toString(36).substr(2,6).toUpperCase()}init(){this.setupListeners();this.renderCalendar();this.setupFirestore();this.setupNotifications();document.getElementById('my-room').value=this.roomId;localStorage.setItem('roomId',this.roomId);if(this.currentUser){document.querySelector(`[data-value="${this.currentUser}"]`).classList.add('selected')}for(let i=1;i<=31;i++){document.getElementById('md').innerHTML+=`<option value="${i}">${i}</option>`}}setupFirestore(){this.db.collection('rooms').doc(this.roomId).onSnapshot(doc=>{if(doc.exists){const data=doc.data();this.tasks=data.tasks||[];this.completions=data.completions||{};this.renderCalendar();document.getElementById('sync-status').textContent='Connected'}else{this.syncNow()}},()=>{document.getElementById('sync-status').textContent='Offline'})}syncNow(){this.db.collection('rooms').doc(this.roomId).set({tasks:this.tasks,completions:this.completions,updated:new Date()}).then(()=>{document.getElementById('sync-status').textContent='Synced'}).catch(()=>{document.getElementById('sync-status').textContent='Error'})}joinRoom(){const code=document.getElementById('room-code').value.trim().toUpperCase();if(code){this.roomId=code;localStorage.setItem('roomId',code);document.getElementById('my-room').value=code;this.setupFirestore()}}copyRoom(){navigator.clipboard.writeText(this.roomId)}setupListeners(){document.querySelectorAll('.tab').forEach(tab=>{tab.addEventListener('click',()=>this.switchTab(tab.dataset.tab))});document.getElementById('te').addEventListener('click',()=>{document.getElementById('emoji-picker').classList.toggle('hidden')});document.querySelectorAll('.emoji-option').forEach(emoji=>{emoji.addEventListener('click',()=>{document.getElementById('te').value=emoji.dataset.emoji;document.getElementById('emoji-picker').classList.add('hidden')})});document.addEventListener('click',(e)=>{const emojiSection=e.target.closest('.fg');const isEmojiInput=e.target.id==='te';const isEmojiPicker=e.target.closest('#emoji-picker');if(!isEmojiInput&&!isEmojiPicker){document.getElementById('emoji-picker').classList.add('hidden')}});document.getElementById('pm').addEventListener('click',()=>{this.currentDate.setMonth(this.currentDate.getMonth()-1);this.renderCalendar()});document.getElementById('nm').addEventListener('click',()=>{this.currentDate.setMonth(this.currentDate.getMonth()+1);this.renderCalendar()});document.getElementById('tf').addEventListener('submit',e=>{e.preventDefault();this.addTask()});document.getElementById('en').addEventListener('click',()=>{this.requestNotifications()});document.querySelectorAll('.rop').forEach(el=>{el.addEventListener('click',()=>{const parent=el.parentElement;parent.querySelectorAll('.rop').forEach(r=>r.classList.remove('selected'));el.classList.add('selected');if(parent.previousElementSibling.textContent.includes('I am')){this.currentUser=el.dataset.value;localStorage.setItem('currentUser',this.currentUser)}else if(parent.previousElementSibling.textContent.includes('Assigned')){this.selectedAssignment=el.dataset.value;document.getElementById('alt-start').classList.toggle('hidden',el.dataset.value!=='alternating')}else{this.selectedRepeat=el.dataset.value;document.getElementById('start-day').classList.toggle('hidden',!['every-other-day','quarterly'].includes(el.dataset.value));document.getElementById('week-day').classList.toggle('hidden',el.dataset.value!=='weekly');document.getElementById('twice-days').classList.toggle('hidden',el.dataset.value!=='twice-weekly');document.getElementById('month-day').classList.toggle('hidden',!['monthly','quarterly'].includes(el.dataset.value));document.getElementById('custom-days').classList.toggle('hidden',el.dataset.value!=='custom')}})});document.querySelectorAll('.db').forEach(btn=>{btn.addEventListener('click',()=>{btn.classList.toggle('selected');const day=btn.dataset.day;if(this.selectedDays.has(day)){this.selectedDays.delete(day)}else{this.selectedDays.add(day)}})})}switchTab(tab){document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.tc').forEach(c=>c.classList.remove('active'));document.querySelector(`[data-tab="${tab}"]`).classList.add('active');document.getElementById(tab).classList.add('active')}renderCalendar(){const year=this.currentDate.getFullYear();const month=this.currentDate.getMonth();document.getElementById('cm').textContent=new Date(year,month).toLocaleDateString('en-US',{month:'long',year:'numeric'});const firstDay=new Date(year,month,1);const startDate=new Date(firstDay);startDate.setDate(startDate.getDate()-(firstDay.getDay()||7)+1);const grid=document.getElementById('cg');grid.innerHTML='';['M','T','W','T','F','S','S'].forEach(day=>{const h=document.createElement('div');h.className='cdh';h.textContent=day;grid.appendChild(h)});for(let i=0;i<42;i++){const date=new Date(startDate);date.setDate(startDate.getDate()+i);const el=document.createElement('div');el.className='cd';if(date.getMonth()!==month)el.classList.add('other-month');if(date.toDateString()===new Date().toDateString())el.classList.add('today');const dayTasks=this.getTasksForDay(date);el.innerHTML=`<div class="dn">${date.getDate()}</div>${dayTasks.slice(0,2).map(task=>{const person=this.getAssignedPerson(task,date);const completed=this.isCompleted(task.id,date);return `<div class="tp ${completed?'completed':person}">${task.emoji||'📋'} ${task.name}</div>`}).join('')}${dayTasks.length>2?`<div class="tp">+${dayTasks.length-2}</div>`:''}`;el.addEventListener('click',()=>this.showDay(date,dayTasks));grid.appendChild(el)}}getTasksForDay(date){return this.tasks.filter(task=>this.isTaskOnDay(task,date))}isTaskOnDay(task,date){const start=new Date(task.created);if(date<start)return false;const day=date.getDay()||7;const daysDiff=Math.floor((date-start)/(86400000));switch(task.repeat){case 'daily':return true;case 'every-other-day':return daysDiff>=0&&daysDiff%2===0;case 'weekly':return day==task.weekDay;case 'twice-weekly':return task.twiceDays&&task.twiceDays.includes(day.toString());case 'monthly':return date.getDate()==task.monthDay;case 'quarterly':const monthsDiff=(date.getFullYear()-start.getFullYear())*12+date.getMonth()-start.getMonth();return monthsDiff>=0&&monthsDiff%3===0&&date.getDate()==task.monthDay;case 'custom':return task.customDays.includes(day.toString());default:return false}}getAssignedPerson(task,date){if(task.assigned!=='alternating')return task.assigned;const start=new Date(task.created);const days=Math.floor((date-start)/(86400000));let count=0;for(let i=0;i<=days;i++){const d=new Date(start);d.setDate(start.getDate()+i);if(this.isTaskOnDay(task,d))count++}return task.altStart===(count%2?'alex':'bethany')?task.altStart:(task.altStart==='alex'?'bethany':'alex')}isCompleted(taskId,date){const key=`${taskId}_${date.toDateString()}`;return this.completions[key]||false}toggleComplete(taskId,date){const key=`${taskId}_${date.toDateString()}`;this.completions[key]=!this.completions[key];this.syncNow();this.renderCalendar();this.showDay(date,this.getTasksForDay(date))}showDay(date,tasks){document.getElementById('md').textContent=date.toLocaleDateString();document.getElementById('mt').innerHTML=tasks.length?tasks.map(task=>{const person=this.getAssignedPerson(task,date);const personText=person==='alex'?'👨 Alex':person==='bethany'?'👩 Bethany':person==='both'?'👥 Both':'🔄 Alt';const completed=this.isCompleted(task.id,date);return `<div class="td ${completed?'completed':''}"><h4>${task.emoji||'📋'} ${task.name}</h4><p>${personText} • ${task.time}</p><button class="btn-s btn-c" onclick="ts.toggleComplete(${task.id},new Date('${date.toISOString()}'))">${completed?'Undo':'Complete'}</button><button class="btn-s btn-d" onclick="ts.deleteTask(${task.id})">Delete</button></div>`}).join(''):'<p style="text-align:center;color:#666">No tasks</p>';document.getElementById('tm').style.display='block'}addTask(){const name=document.getElementById('tn').value;const emoji=document.getElementById('te').value;const time=document.getElementById('tt').value;if(!name||!time||!this.selectedAssignment||!this.selectedRepeat){alert('Fill required fields');return}if(this.selectedRepeat==='custom'&&!this.selectedDays.size){alert('Select days');return}if(this.selectedRepeat==='twice-weekly'&&this.selectedDays.size!==2){alert('Select exactly 2 days');return}const now = new Date();
now.setHours(0, 0, 0, 0); // Set time to 00:00:00
const task = {
  id: Date.now(),
  name,
  emoji,
  time,
  assigned: this.selectedAssignment,
  repeat: this.selectedRepeat,
  created: now.toISOString()
};if(this.selectedAssignment==='alternating'){task.altStart=document.getElementById('as').value}if(['every-other-day','quarterly'].includes(this.selectedRepeat)){task.startDay=document.getElementById('std').value}if(this.selectedRepeat==='weekly'){task.weekDay=document.getElementById('wd').value}if(['monthly','quarterly'].includes(this.selectedRepeat)){task.monthDay=document.getElementById('md').value}if(this.selectedRepeat==='twice-weekly'){task.twiceDays=Array.from(this.selectedDays)}if(this.selectedRepeat==='custom'){task.customDays=Array.from(this.selectedDays)}this.tasks.push(task);this.syncNow();this.resetForm();this.switchTab('calendar')}deleteTask(id){this.tasks=this.tasks.filter(t=>t.id!==id);this.syncNow();this.renderCalendar();document.getElementById('tm').style.display='none'}resetForm(){document.getElementById('tf').reset();document.querySelectorAll('.selected').forEach(el=>{if(!el.dataset.value||!['alex','bethany'].includes(el.dataset.value))el.classList.remove('selected')});document.querySelectorAll('.hidden').forEach(el=>el.classList.add('hidden'));this.selectedDays.clear();this.selectedAssignment='';this.selectedRepeat=''}requestNotifications(){if('Notification'in window){Notification.requestPermission().then(p=>{if(p==='granted'){this.showNotification('✅ Notifications enabled!')}})}}showNotification(msg,icon='📋'){if('Notification'in window&&Notification.permission==='granted'){new Notification(msg,{icon:'/android-chrome-192x192.png',badge:'/android-chrome-192x192.png',body:icon,silent:false,tag:'task-reminder'})}}setupNotifications(){if('serviceWorker'in navigator){navigator.serviceWorker.register('sw.js').catch(e=>console.log('SW fail'))}setInterval(()=>{if(!this.currentUser)return;const now=new Date();const time=now.getHours().toString().padStart(2,'0')+':'+now.getMinutes().toString().padStart(2,'0');this.getTasksForDay(now).forEach(task=>{if(task.time===time&&!this.isCompleted(task.id,now)){const assignedPerson=this.getAssignedPerson(task,now);this.showNotification(`${task.emoji || '📋'} ${task.name}`, task.emoji || '📋');}})},30000)}}const ts=new TaskScheduler()</script></body></html>
